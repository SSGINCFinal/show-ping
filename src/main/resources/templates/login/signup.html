<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShowPing íšŒì›ê°€ì…</title>
    <link rel="stylesheet" href="/css/login/signup.css">
    <script src="/js/jwt.js"></script>
</head>
<body>
<div class="container">
    <div class="logo-area">
        <h1>ShowPing!</h1>
        <div class="logo">S</div>
    </div>
    <div class="signup-form">
        <h2>íšŒì›ê°€ì…</h2>

        <!-- ì´ë¦„ ì…ë ¥ -->
        <input type="text" placeholder="ì´ë¦„">

        <!-- ì´ë©”ì¼ ì¸ì¦ -->
        <div class="input-group">
            <input type="email" placeholder="ì´ë©”ì¼" id="email">
            <button class="verify-btn">ì¸ì¦ ì½”ë“œ ë³´ë‚´ê¸°</button>
        </div>

        <!-- ì´ë©”ì¼ ì¸ì¦ ì½”ë“œ ì…ë ¥ -->
        <div class="input-group" id="email-verify-section">
            <input type="text" placeholder="ì¸ì¦ ì½”ë“œ ì…ë ¥" id="email-code">
            <button class="verify-code-btn">í™•ì¸</button>
        </div>

        <!-- ì•„ì´ë”” ì…ë ¥ & ì¤‘ë³µ í™•ì¸ -->
        <div class="input-group">
            <input type="text" placeholder="ì•„ì´ë””">
            <button class="check-id-btn">ì¤‘ë³µ í™•ì¸</button>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ -->
        <div class="input-group">
            <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
            <button type="button" class="toggle-password">ğŸ‘</button>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ -->
        <div class="input-group">
            <input type="password" id="confirm-password" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
            <button type="button" class="toggle-password">ğŸ‘</button>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ë²„íŠ¼ -->
        <div>
            <button type="button" class="check-password-btn">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</button>
        </div>

        <!-- ì£¼ì†Œ ì…ë ¥ & ê²€ìƒ‰ -->
        <div class="input-group">
            <input type="text" placeholder="ì£¼ì†Œ" id="address">
            <button type="button" class="find-address-btn">ì£¼ì†Œ ê²€ìƒ‰</button>
        </div>

        <button type="submit">ê°€ì…í•˜ê¸°</button>
    </div>
</div>

<script>
    // ë¹„ë°€ë²ˆí˜¸ ë³´ì´ê¸°/ìˆ¨ê¸°ê¸° ê¸°ëŠ¥
    document.querySelectorAll('.toggle-password').forEach(button => {
        button.addEventListener('click', function () {
            const input = this.previousElementSibling;
            if (input.type === "password") {
                input.type = "text";
                this.textContent = "ğŸ”’";
            } else {
                input.type = "password";
                this.textContent = "ğŸ‘";
            }
        });
    });

    document.querySelector('.verify-btn').addEventListener('click', function () {
        const email = document.getElementById('email').value;

        if (!validateEmail(email)) {
            alert("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
            return;
        }
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        fetch('/signup/send-code', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email: email })
        })
            .then(response => response.text())
            .then(data => {
                alert("ì¸ì¦ ì½”ë“œê°€ ì´ë©”ì¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
                console.log("ì„œë²„ ì‘ë‹µ:", data);
            })
            .catch(error => {
                console.error("ì˜¤ë¥˜ ë°œìƒ:", error);
                alert("ì´ë©”ì¼ ì „ì†¡ ì‹¤íŒ¨");
            });
    });

    document.querySelector('.verify-code-btn').addEventListener('click', function () {
        const email = document.getElementById('email').value;
        const emailCode = document.getElementById('email-code').value;

        fetch(`/signup/verify-code?email=${encodeURIComponent(email)}&code=${encodeURIComponent(emailCode)}`, {
            method: 'POST'
        })
            .then(response => response.json())
            .then(isValid => {
                if (isValid) {
                    alert("ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ!");
                } else {
                    alert("ì¸ì¦ ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                }
            })
            .catch(error => {
                console.error("ì˜¤ë¥˜ ë°œìƒ:", error);
                alert("ì¸ì¦ ì½”ë“œ í™•ì¸ ì‹¤íŒ¨");
            });
    });

    // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
    document.querySelector('.check-password-btn').addEventListener('click', function () {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirm-password').value;

        if (password === confirmPassword) {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.");
        } else {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
    });
    fetch('/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ memberId: 'test123', password: 'password123' })
    })
        .then(response => response.json())
        .then(data => {
            if (data.accessToken) {
                localStorage.setItem('accessToken', data.accessToken);
                localStorage.setItem('refreshToken', data.refreshToken);
                console.log('ë¡œê·¸ì¸ ì„±ê³µ:', data);
            } else {
                console.log('ë¡œê·¸ì¸ ì‹¤íŒ¨:', data.error);
            }
        });
</script>

<style>
    .input-group {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
    }
    .input-group input {
        flex: 1;
    }
    .hidden {
        display: none;
    }
</style>

</body>
</html>
